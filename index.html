<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            margin: 0; 
            font-family: Arial, sans-serif; 
            background: linear-gradient(145deg, #e0eafc, #cfdef3);
            min-height: 100vh;
        }

        .container { 
            max-width: 500px; 
            margin: 50px auto; 
            background: white; 
            padding: 20px; 
            border-radius: 12px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.2); 
        }

        h1 { text-align: center; }

        label { display: block; margin-top: 15px; font-weight: bold; }

        input, select { 
            width: 100%; 
            padding: 10px; 
            margin-top: 5px; 
            font-size: 16px; 
            border-radius: 6px; 
            border: 1px solid #ccc;
        }

        button { 
            background-color: #2d89ef; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            padding: 10px; 
            font-size: 16px; 
            cursor: pointer; 
            margin-top: 10px;
        }

        .button-row { display: flex; gap: 10px; margin-top: 15px; }

        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #2d89ef; color: white; }

        .edit-btn { background: orange; color: white; border: none; padding: 5px; }
        .delete-btn { background: black; color: white; border: none; padding: 5px; }
    </style>
</head>

<body>
<div class="container">
    <h1>Expense Tracker</h1>

    <!-- Currency Selector -->
    <label>Select Currency</label>
    <select id="currencySelect" onchange="changeCurrency()">
        <option value="INR">India (₹)</option>
        <option value="USD">USA ($)</option>
        <option value="GBP">UK (£)</option>
        <option value="EUR">Europe (€)</option>
        <option value="CNY">China (¥)</option>
        <option value="JPY">Japan (¥)</option>
        <option value="AED">UAE (د.إ)</option>
    </select>

    <label>Amount</label>
    <input type="number" id="amount">

    <label>Category</label>
    <select id="category">
        <option value="">Select category</option>
        <option>Food</option>
        <option>Travel</option>
        <option>Shopping</option>
        <option>Other</option>
    </select>

    <label>Date</label>
    <input type="date" id="date">

    <button id="addBtn" onclick="addExpense()">Add Expense</button>

    <h3 id="total">Total: ₹0</h3>

    <div class="button-row">
        <button onclick="setDateFilter('daily')">Daily</button>
        <button onclick="setDateFilter('weekly')">Weekly</button>
        <button onclick="setDateFilter('monthly')">Monthly</button>
        <button onclick="setDateFilter('all')">All</button>
    </div>

    <label>Filter by Category</label>
    <select id="categoryFilter" onchange="applyFilters()">
        <option value="All">All</option>
        <option>Food</option>
        <option>Travel</option>
        <option>Shopping</option>
        <option>Other</option>
    </select>

    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="summaryBody"></tbody>
    </table>
</div>

<script>
/* ---------- Currency Logic (DISPLAY ONLY) ---------- */

const currencyMap = {
    INR: "₹",
    USD: "$",
    GBP: "£",
    EUR: "€",
    CNY: "¥",
    JPY: "¥",
    AED: "د.إ"
};

let selectedCurrency = localStorage.getItem("currency") || "INR";
document.getElementById("currencySelect").value = selectedCurrency;

function changeCurrency() {
    selectedCurrency = document.getElementById("currencySelect").value;
    localStorage.setItem("currency", selectedCurrency);
    applyFilters();
}

function fmt(amount) {
    return currencyMap[selectedCurrency] + amount;
}

/* ---------- ORIGINAL LOGIC (UNCHANGED) ---------- */

let expenses = JSON.parse(localStorage.getItem("expenses")) || [];
let editId = null;
let currentDateFilter = 'all';

applyFilters();

function addExpense() {
    let amount = document.getElementById("amount").value;
    let category = document.getElementById("category").value;
    let date = document.getElementById("date").value;

    if (!amount || !category || !date) {
        alert("Please fill all fields");
        return;
    }

    if (editId) {
        expenses = expenses.map(exp =>
            exp.id === editId ? { ...exp, amount, category, date } : exp
        );
        editId = null;
        document.getElementById("addBtn").innerText = "Add Expense";
    } else {
        expenses.push({ id: Date.now(), amount, category, date });
    }

    saveExpenses();
    applyFilters();

    document.getElementById("amount").value = "";
    document.getElementById("category").value = "";
    document.getElementById("date").value = "";
}

function saveExpenses() {
    localStorage.setItem("expenses", JSON.stringify(expenses));
}

function setDateFilter(type) {
    currentDateFilter = type;
    applyFilters();
}

function applyFilters() {
    let filtered = [...expenses];
    let today = new Date();

    if (currentDateFilter === 'weekly') {
        let start = new Date(today);
        start.setDate(today.getDate() - today.getDay());
        let end = new Date(start);
        end.setDate(start.getDate() + 6);
        filtered = filtered.filter(e => {
            let d = new Date(e.date);
            return d >= start && d <= end;
        });
    } 
    else if (currentDateFilter === 'monthly') {
        filtered = filtered.filter(e => {
            let d = new Date(e.date);
            return d.getMonth() === today.getMonth() &&
                   d.getFullYear() === today.getFullYear();
        });
    }

    let cat = document.getElementById("categoryFilter").value;
    if (cat !== "All") {
        filtered = filtered.filter(e => e.category === cat);
    }

    display(filtered);
}

function display(list) {
    let totalAmt = list.reduce((s, e) => s + Number(e.amount), 0);
    document.getElementById("total").innerText =
        "Total: " + fmt(totalAmt);

    let tbody = document.getElementById("summaryBody");
    tbody.innerHTML = "";

    if (list.length === 0) {
        tbody.innerHTML = `<tr><td colspan="4">No expenses to show</td></tr>`;
        return;
    }

    list.forEach(e => {
        tbody.innerHTML += `
            <tr>
                <td>${e.date}</td>
                <td>${e.category}</td>
                <td>${fmt(e.amount)}</td>
                <td>
                    <button class="edit-btn" onclick="editExpense(${e.id})">Edit</button>
                    <button class="delete-btn" onclick="deleteExpense(${e.id})">X</button>
                </td>
            </tr>`;
    });
}

function editExpense(id) {
    let e = expenses.find(x => x.id === id);
    document.getElementById("amount").value = e.amount;
    document.getElementById("category").value = e.category;
    document.getElementById("date").value = e.date;
    editId = id;
    document.getElementById("addBtn").innerText = "Update Expense";
}

function deleteExpense(id) {
    expenses = expenses.filter(e => e.id !== id);
    saveExpenses();
    applyFilters();
}
</script>
</body>
</html>

